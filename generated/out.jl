"""

The code in file has been generated by NYXX Code Generator on 07/24/2020, 12:41:38. Consider
testing this code before using it as errors remain possible. For more details, check out the
github repository of this projets at https://github.com/Teskann/NYXX.

"""

using LinearAlgebra

# ------------------------------------------------------------------------------------------
# |                              FORWARD TRANSISION MATRICES                               |
# ------------------------------------------------------------------------------------------

# Joint 0 __________________________________________________________________________________

"""
    T_joint1(theta_joint1)

Description
-----------

Transition Matrix to go from link link1 to link link2.
This joint is continuous. The matrix is :

[1          0                  0           0]
[                                           ]
[0  cos(theta_joint1)  -sin(theta_joint1)  0]
[                                           ]
[0  sin(theta_joint1)  cos(theta_joint1)   0]
[                                           ]
[0          0                  0           1]

Parameters
----------

theta_joint1 : Float64
    Rotation value (in radians) around the joint1 joint axis.

"""
function T_joint1(theta_joint1)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint1) -sin(theta_joint1) 0;
          0 sin(theta_joint1) cos(theta_joint1) 0;
          0 0 0 1]

    return mat
end

# Joint 1 __________________________________________________________________________________

"""
    T_joint2(theta_joint2)

Description
-----------

Transition Matrix to go from link link1 to link link3.
This joint is continuous. The matrix is :

[1          0                  0           0]
[                                           ]
[0  cos(theta_joint2)  -sin(theta_joint2)  0]
[                                           ]
[0  sin(theta_joint2)  cos(theta_joint2)   0]
[                                           ]
[0          0                  0           1]

Parameters
----------

theta_joint2 : Float64
    Rotation value (in radians) around the joint2 joint axis.

"""
function T_joint2(theta_joint2)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint2) -sin(theta_joint2) 0;
          0 sin(theta_joint2) cos(theta_joint2) 0;
          0 0 0 1]

    return mat
end

# Joint 2 __________________________________________________________________________________

"""
    T_joint3(theta_joint3)

Description
-----------

Transition Matrix to go from link link3 to link link4.
This joint is continuous. The matrix is :

[1          0                  0           0]
[                                           ]
[0  cos(theta_joint3)  -sin(theta_joint3)  0]
[                                           ]
[0  sin(theta_joint3)  cos(theta_joint3)   0]
[                                           ]
[0          0                  0           1]

Parameters
----------

theta_joint3 : Float64
    Rotation value (in radians) around the joint3 joint axis.

"""
function T_joint3(theta_joint3)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint3) -sin(theta_joint3) 0;
          0 sin(theta_joint3) cos(theta_joint3) 0;
          0 0 0 1]

    return mat
end

# ------------------------------------------------------------------------------------------
# |                              BACKWARD TRANSISION MATRICES                              |
# ------------------------------------------------------------------------------------------

# Joint 0 Inverse __________________________________________________________________________

"""
    T_joint1_inv(theta_joint1)

Description
-----------

Transition Matrix to go from link link2 to link link1.
This joint is continuous. The matrix is :

[1          0                   0          0]
[                                           ]
[0  cos(theta_joint1)   sin(theta_joint1)  0]
[                                           ]
[0  -sin(theta_joint1)  cos(theta_joint1)  0]
[                                           ]
[0          0                   0          1]


Parameters
----------

theta_joint1 : Float64
    Rotation value (in radians) around the joint1 joint axis.

"""
function T_joint1_inv(theta_joint1)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint1) sin(theta_joint1) 0;
          0 -sin(theta_joint1) cos(theta_joint1) 0;
          0 0 0 1]

    return mat
end

# Joint 1 Inverse __________________________________________________________________________

"""
    T_joint2_inv(theta_joint2)

Description
-----------

Transition Matrix to go from link link3 to link link1.
This joint is continuous. The matrix is :

[1          0                   0          0]
[                                           ]
[0  cos(theta_joint2)   sin(theta_joint2)  0]
[                                           ]
[0  -sin(theta_joint2)  cos(theta_joint2)  0]
[                                           ]
[0          0                   0          1]


Parameters
----------

theta_joint2 : Float64
    Rotation value (in radians) around the joint2 joint axis.

"""
function T_joint2_inv(theta_joint2)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint2) sin(theta_joint2) 0;
          0 -sin(theta_joint2) cos(theta_joint2) 0;
          0 0 0 1]

    return mat
end

# Joint 2 Inverse __________________________________________________________________________

"""
    T_joint3_inv(theta_joint3)

Description
-----------

Transition Matrix to go from link link4 to link link3.
This joint is continuous. The matrix is :

[1          0                   0          0]
[                                           ]
[0  cos(theta_joint3)   sin(theta_joint3)  0]
[                                           ]
[0  -sin(theta_joint3)  cos(theta_joint3)  0]
[                                           ]
[0          0                   0          1]


Parameters
----------

theta_joint3 : Float64
    Rotation value (in radians) around the joint3 joint axis.

"""
function T_joint3_inv(theta_joint3)
    
    # Returned Matrix
    mat = [1 0 0 0;
          0 cos(theta_joint3) sin(theta_joint3) 0;
          0 -sin(theta_joint3) cos(theta_joint3) 0;
          0 0 0 1]

    return mat
end

# ------------------------------------------------------------------------------------------
# |                                   FORWARD KINEMATICS                                   |
# ------------------------------------------------------------------------------------------

# Forward Kinematics from link_0 to link_1 _________________________________________________

"""
    fk_link1_link2(q)

Description
-----------

Comuputes  the  forward  kinematics  from  the  link  link1 to the link link2. The result is
returned as a 4x4 Matrix in homogeneous coordinates.

Parameters
----------

q : Vector
    Vector of variables where :
        - q[1] = theta_joint1 :
              Rotation value (in radians) around the joint1 joint axis.

"""
function fk_link1_link2(q)
    
    T_0 = T_joint1(q[1])
    
    return T_0
end

# Forward Kinematics from link_0 to link_3 _________________________________________________

"""
    fk_link1_link4(q)

Description
-----------

Comuputes  the  forward  kinematics  from  the  link  link1 to the link link4. The result is
returned as a 4x4 Matrix in homogeneous coordinates.

Parameters
----------

q : Vector
    Vector of variables where :
        - q[1] = theta_joint2 :
              Rotation value (in radians) around the joint2 joint axis.
        - q[2] = theta_joint3 :
              Rotation value (in radians) around the joint3 joint axis.

"""
function fk_link1_link4(q)
    
    T_1 = T_joint2(q[1])
    T_2 = T_joint3(q[2])
    
    return T_1*T_2
end

# ------------------------------------------------------------------------------------------
# |                                       JACOBIANS                                        |
# ------------------------------------------------------------------------------------------

# Jacobian of the link_1 position and orientation __________________________________________

"""
    jacobian_link1_to_link2(p0, q)

Description
-----------

Computes  the Jacobian Matrix of the link2 coordinates in the link1 frame from the point p0.
This  matrix  is  returned  as  a (6 x 1) matrix where every column is the derivative of the
position/orientation with respect to a degree of freedom.
    - The line 1 is the derivative of X position of link2 in the link1 frame,
    - The line 2 is the derivative of Y position of link2 in the link1 frame,
    - The line 3 is the derivative of Z position of link2 in the link1 frame,
    - The line 4 is the derivative of the roll orientation of link2 in the link1 frame,
    - The line 5 is the derivative of the pitch orientation of link2 in the link1 frame,
    - The line 6 is the derivative of the yaw orientation of link2 in the link1 frame,
Here is the list of all the derivative variables :
    - Column 1 : theta_joint1

Parameters
----------

p0 : Vector
    Point  in the link1 frame where you want to compute the Jacobian Matrix. p0 is a (3 x 1)
    vector.

q : Vector
    Vector  of length 1 containing all the degrees of freedom of the robot between link1 and
    link2 chain. This vector contains :
        - q[1] = theta_joint1 :
              Rotation value (in radians) around the joint1 joint axis.

"""
function jacobian_link1_to_link2(p0, q)
    
    Jac = zeros(6, 1)
    T = T_joint1(q[1])
    L = p0-T[1:3,4]
    Z = T[1:3,3]
    Jac[1:3,1] = cross(Z,L)
    Jac[4:6,1] = Z
    
    return Jac
end

# Jacobian of the link_3 position and orientation __________________________________________

"""
    jacobian_link1_to_link4(p0, q)

Description
-----------

Computes  the Jacobian Matrix of the link4 coordinates in the link1 frame from the point p0.
This  matrix  is  returned  as  a (6 x 2) matrix where every column is the derivative of the
position/orientation with respect to a degree of freedom.
    - The line 1 is the derivative of X position of link4 in the link1 frame,
    - The line 2 is the derivative of Y position of link4 in the link1 frame,
    - The line 3 is the derivative of Z position of link4 in the link1 frame,
    - The line 4 is the derivative of the roll orientation of link4 in the link1 frame,
    - The line 5 is the derivative of the pitch orientation of link4 in the link1 frame,
    - The line 6 is the derivative of the yaw orientation of link4 in the link1 frame,
Here is the list of all the derivative variables :
    - Column 1 : theta_joint2
    - Column 2 : theta_joint3

Parameters
----------

p0 : Vector
    Point  in the link1 frame where you want to compute the Jacobian Matrix. p0 is a (3 x 1)
    vector.

q : Vector
    Vector  of length 2 containing all the degrees of freedom of the robot between link1 and
    link4 chain. This vector contains :
        - q[1] = theta_joint2 :
              Rotation value (in radians) around the joint2 joint axis.
        - q[2] = theta_joint3 :
              Rotation value (in radians) around the joint3 joint axis.

"""
function jacobian_link1_to_link4(p0, q)
    
    Jac = zeros(6, 2)
    T = T_joint2(q[1])
    L = p0-T[1:3,4]
    Z = T[1:3,3]
    Jac[1:3,1] = cross(Z,L)
    Jac[4:6,1] = Z
    T = T*T_joint3(q[2])
    L = p0-T[1:3,4]
    Z = T[1:3,3]
    Jac[1:3,2] = cross(Z,L)
    Jac[4:6,2] = Z
    
    return Jac
end

# Center of mass function can not be generated because the robot mass is null.

# Center of mass jacobian function can not be generated because the robot mass is null.
